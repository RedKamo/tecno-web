---
import Layout from "@/layouts/Layout.astro";
import { Icon } from "astro-icon/components";
---

<Layout title="Contáctenos">
  <main class="py-20 bg-gray-50">
    <section class="max-w-6xl mx-auto px-4">
      <header class="text-center mb-12">
        <p class="text-sky-600 mb-2">Soporte y Ventas</p>
        <h1 class="text-4xl font-bold">Contáctenos</h1>
        <p class="text-gray-600 mt-2">
          Estamos aquí para responder sus preguntas y discutir las necesidades
          de su empresa
        </p>
      </header>

      <section class="grid md:grid-cols-2 gap-12">
        <form
          id="contactForm"
          class="bg-white p-8 rounded-lg shadow-sm"
          action="https://formspree.io/f/movqlwka"
          method="POST"
        >
          <input
            type="text"
            name="nombre"
            placeholder="Nombre"
            required
            minlength="2"
            pattern="[A-Za-zÀ-ÿ\s]+"
            title="Por favor ingrese un nombre válido (solo letras y espacios)"
            class="w-full mb-6 p-4 border border-gray-200 rounded-lg focus:border-sky-500 focus:ring-1 focus:ring-sky-500 outline-none"
          />

          <input
            type="text"
            name="compania"
            placeholder="Compañía"
            required
            minlength="2"
            class="w-full mb-6 p-4 border border-gray-200 rounded-lg focus:border-sky-500 focus:ring-1 focus:ring-sky-500 outline-none"
          />

          <input
            type="email"
            name="email"
            placeholder="Correo electrónico"
            required
            pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$"
            title="Por favor ingrese un correo electrónico válido"
            class="w-full mb-6 p-4 border border-gray-200 rounded-lg focus:border-sky-500 focus:ring-1 focus:ring-sky-500 outline-none"
          />

          <input
            type="text"
            name="asunto"
            placeholder="Asunto"
            required
            minlength="4"
            class="w-full mb-6 p-4 border border-gray-200 rounded-lg focus:border-sky-500 focus:ring-1 focus:ring-sky-500 outline-none"
          />

          <textarea
            name="mensaje"
            placeholder="Mensaje"
            rows="5"
            required
            minlength="10"
            class="w-full mb-6 p-4 border border-gray-200 rounded-lg focus:border-sky-500 focus:ring-1 focus:ring-sky-500 outline-none resize-none"
          ></textarea>

          <label class="flex items-start gap-2 mb-6">
            <input type="checkbox" name="autorizacion" required class="mt-1" />
            <span class="text-sm text-gray-600">
              Autorizo el tratamiento de mis datos personales según la
              <a
                href="/politica-privacidad"
                class="text-sky-700 hover:underline font-medium"
                >política de privacidad</a
              >
            </span>
          </label>

          <button
            type="submit"
            style="background-color: #0284C7; color: white; padding: 0.75rem; width: 100%; border-radius: 8px; margin-top: 1rem;"
          >
            Enviar mensaje
          </button>
        </form>

        <section class="space-y-8">
          <iframe
            title="Ubicación de Tecnoevolución en Bogotá"
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3976.5254274926837!2d-74.11659792414567!3d4.6754435422256085!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8e3f9b6374987ef5%3A0x4e2b3a4c87eb9d2c!2sCl.%2026%20%2369-63%2C%20Bogot%C3%A1%2C%20Colombia!5e0!3m2!1ses!2sco!4v1709852292044!5m2!1ses!2sco"
            class="w-full h-[400px] rounded-lg"
            allowfullscreen=""
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"></iframe>

          <section class="bg-white p-8 rounded-lg shadow-sm">
            <h2 class="text-2xl mb-6">Información de contacto</h2>
            <div class="space-y-6">
              <div class="flex gap-4">
                <Icon
                  name="tabler:map-pin"
                  class="w-6 h-6 text-sky-600 flex-shrink-0"
                />
                <div>
                  <p class="text-sky-700">Bogotá, Colombia – Sur América:</p>
                  <p>Calle 26 No. 69-63</p>
                  <p>Oficina 211 Centro Empresarial Torre 26</p>
                </div>
              </div>

              <div class="flex gap-4">
                <Icon
                  name="tabler:phone"
                  class="w-6 h-6 text-sky-600 flex-shrink-0"
                />
                <div>
                  <p class="text-sky-700">Teléfono:</p>
                  <p>(601) 4270717 / 320 488 9601</p>
                </div>
              </div>

              <div class="flex gap-4">
                <Icon
                  name="tabler:mail"
                  class="w-6 h-6 text-sky-600 flex-shrink-0"
                />
                <div>
                  <p class="text-sky-700">Email:</p>
                  <a
                    href="mailto:dialogo@tecnoevolucion.com"
                    class="text-sky-700 hover:underline font-medium"
                  >
                    dialogo@tecnoevolucion.com
                  </a>
                </div>
              </div>
            </div>
          </section>
        </section>
      </section>
    </section>
  </main>
</Layout>

<style is:global>
  [data-sonner-toaster] {
    position: fixed;
    width: var(--width);
    font-family:
      ui-sans-serif,
      system-ui,
      -apple-system,
      BlinkMacSystemFont,
      Segoe UI,
      Roboto,
      Helvetica Neue,
      Arial,
      Noto Sans,
      sans-serif;
    box-sizing: border-box;
    z-index: 999999;
    padding: 0.75rem;
  }

  [data-sonner-toaster][data-position^="top"] {
    top: env(safe-area-inset-top, 0);
  }

  [data-sonner-toaster][data-position^="bottom"] {
    bottom: env(safe-area-inset-bottom, 0);
  }

  [data-sonner-toaster][data-position$="right"] {
    right: env(safe-area-inset-right, 0);
  }

  [data-sonner-toast] {
    position: relative;
    width: var(--width);
    display: flex;
    align-items: center;
    background: white;
    border-radius: 0.5rem;
    box-shadow:
      0 4px 6px -1px rgb(0 0 0 / 0.1),
      0 2px 4px -2px rgb(0 0 0 / 0.1);
  }
</style>

<script>
  import Swal from "sweetalert2";

  const form = document.querySelector("#contactForm");

  form?.addEventListener("submit", async (e) => {
    e.preventDefault();

    Swal.fire({
      toast: true,
      position: "bottom",
      title: "Enviando mensaje...",
      showConfirmButton: false,
      background: "#f8f9fa",
      didOpen: () => {
        Swal.showLoading();
      },
    });

    try {
      const formData = new FormData(e.target as HTMLFormElement);

      const response = await fetch(form?.getAttribute("action") || "", {
        method: "POST",
        body: formData,
        headers: {
          Accept: "application/json",
        },
      });

      if (response.ok) {
        (e.target as HTMLFormElement).reset();
        Swal.fire({
          toast: true,
          position: "bottom",
          icon: "success",
          title: "¡Mensaje enviado con éxito!",
          showConfirmButton: false,
          timer: 3000,
          background: "#f8f9fa",
          iconColor: "#22c55e",
          customClass: {
            popup: "custom-toast",
          },
        });
      } else {
        throw new Error("Error en el envío");
      }
    } catch (error) {
      Swal.fire({
        toast: true,
        position: "bottom",
        icon: "error",
        title: "Error al enviar el mensaje",
        showConfirmButton: false,
        timer: 3000,
        background: "#f8f9fa",
        iconColor: "#DC2626",
        customClass: {
          popup: "custom-toast",
        },
      });
    }
  });
</script>

<style>
  .custom-toast {
    border-radius: 8px !important;
    padding: 0.75rem !important;
    box-shadow:
      0 4px 6px -1px rgba(0, 0, 0, 0.1),
      0 2px 4px -2px rgba(0, 0, 0, 0.1) !important;
  }
</style>
